<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Pages/Criarcarro/Criarcarro.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Pages/Criarcarro/Criarcarro.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState } from "react";
import Input from "../../Components/Form/Input";
import { Button } from "reactstrap";
import HeaderMain from "../../Components/Header";
import Footer from "../../Components/Footer/footer";
import "./Criarcarro.css";
import {criarCarro} from "../Services/carrosServices.js" ;
import { ToastContainer, toast } from 'react-toastify';
import 'react-toastify/dist/ReactToastify.css';
import { useHistory } from 'react-router-dom';

/**
 * Componente para criar um novo carro para alugar.
 * @param {Object} props - Propriedades passadas para o componente.
 * @param {Function} props.handleSubmit - Função chamada ao enviar o formulário.
 * @param {string} props.botaotxt - Texto exibido no botão de envio.
 * @param {Object} [props.carroData] - Dados iniciais do carro, se disponíveis.
 * @param {string} [props.clienteId] - ID do cliente, se disponível.
 * @returns {React.ReactElement} A página de criação de carro.
 * @description
 * O componente 'Criarcarro' permite que um usuário cadastre um novo carro para ser alugado. O formulário coleta informações como modelo, ano de 
 * fabricação, cidade, preço por dia, detalhes adicionais e um link para uma foto do carro. 
 * Após o envio do formulário, os dados do carro são enviados para um serviço externo e o usuário é notificado sobre o sucesso ou falha do processo.
 */
function Criarcarro({ handleSubmit, botaotxt, carroData, clienteId }) {
  const [carro, setCarro] = useState(carroData || {});
  const [submitted, setSubmitted] = useState(false); 

  const history = useHistory();
  const timer = () => {
    setTimeout(() => {
      //history.push('/');  // Redireciona após o tempo definido
      window.scrollTo({
        top: 0,
        behavior: 'smooth' // Isso adiciona uma rolagem suave
      });
    }, 3000);  // 3000 ms = 3 segundos
  };
  
  /**
   * Função chamada ao enviar o formulário. Valida os dados e envia para o serviço de criação de carro.
   * @param {React.FormEvent&lt;HTMLFormElement>} e - Evento de envio do formulário.
   */
  const submit = async (e) => {
    e.preventDefault();
    if (
      carro.modelo === "" ||
      carro.ano === "" ||
      carro.precoPorDia === "" ||
      carro.cidade === "" ||
      carro.detalhes === "" ||
      carro.fotoLink1 === ""
    ) {
      console.error("Por favor, preencha todos os campos.");
      toast.warning("Por favor, preencha todos os campos.", {
        position: "top-center",
        autoClose: 2700,
        containerId: "shared-toast-container"
      });
      return;
    }

    const carroComCliente = { ...carro };
    console.log("CARRO COM CLIENTE:", carroComCliente);

    const token = localStorage.getItem('token'); 
    console.log("XUXA TESTEEEEEEEEEEE", carro, token);

      try{
        console.log("POST CARRO AQUI", carroComCliente);
        await criarCarro(carroComCliente);
        //console.log("\n\n\LOG DO RESPONSE\n\n", response.data);
        //const {carroCriado} = response.data;
        //const { token, user } = response.data;
        //console.log("Carro cadastrado com sucesso:", carroCriado);
        setSubmitted(true);
  
      }catch(error){
        console.error("Erro ao cadastrar carro:", error);
      };
    
      toast.success("Carro cadastrado com sucesso!", {
        position: "top-center",
        autoClose: 2700,
        containerId: "shared-toast-container"
      });
      timer();


    // axios
    // .post(`http://localhost:5000/carros/`, {modelo: carro.modelo, ano: carro.ano, cidade: carro.cidade, precoPorDia: carro.preco, detalhes: carro.detalhe, fotoLink1: carro.fotoLink1}, {
    //     headers: {
    //       Authorization: `Bearer ${token}`
    //     }
    //   })
    //   .then((response) => {
    //     console.log("Carro cadastrado com sucesso:", response.data);
    //     setSubmitted(true);
    //   })
    //   .catch((error) => {
    //     console.error("Erro ao cadastrar carro:", error);
    //   });
  };

  /**
   * Função chamada ao mudar o valor dos campos do formulário.
   * @param {React.ChangeEvent&lt;HTMLInputElement>} e - Evento de mudança no campo de input.
   */
  function handleChange(e) {
    setCarro({ ...carro, [e.target.name]: e.target.value });
  }

  return (
    &lt;>
      &lt;div className="page-container">
        &lt;HeaderMain />
        &lt;form onSubmit={submit} className="form">
          {submitted ? (
            &lt;div className="thank-you-message">
              &lt;h2>Obrigado pelo envio dos dados!&lt;/h2>
              &lt;p>Em breve estaremos entrando em contato após a análise.&lt;/p>
            &lt;/div>
          ) : (
            &lt;>
              &lt;h2>Cadastrar carro&lt;/h2>
              &lt;h6 style={{ textAlign: "center", marginBottom: "25px" }}>
                Cadastre aqui seu carro para ser alugado
              &lt;/h6>
              &lt;div className="formGroup">
                &lt;Input
                  type="text"
                  text="Modelo do carro"
                  name="modelo"
                  placeholder="Insira o modelo do carro"
                  handleOnChange={handleChange}
                  value={carro.modelo}
                />
              &lt;/div>
              &lt;div className="formGroup">
                &lt;Input
                  type="text"
                  text="Ano de fabricação"
                  name="ano"
                  placeholder="Insira o ano de fabricação"
                  handleOnChange={handleChange}
                  value={carro.ano}
                />
              &lt;/div>
              &lt;div className="formGroup">
                &lt;Input
                  type="text"
                  text="Cidade"
                  name="cidade"
                  placeholder="Insira a cidade"
                  handleOnChange={handleChange}
                  value={carro.cidade}
                />
              &lt;/div>
              &lt;div className="formGroup">
                &lt;Input
                  type="text"
                  text="Preço por dia"
                  name="precoPorDia"
                  placeholder="Insira o custo por dia de aluguel"
                  handleOnChange={handleChange}
                  value={carro.precoPorDia}
                />
              &lt;/div>
              &lt;div className="formGroup">
                &lt;Input
                  type="text"
                  text="Mais detalhes sobre o carro"
                  name="detalhes"
                  placeholder="Insira detalhes sobre o carro"
                  handleOnChange={handleChange}
                  value={carro.detalhes}
                />
              &lt;/div>
              &lt;div className="formGroup">
                &lt;Input
                  type="text"
                  text="Link da foto do seu carro"
                  name="fotoLink1"
                  placeholder="Insira o link da foto do seu carro"
                  handleOnChange={handleChange}
                  value={carro.fotoLink1}
                />
              &lt;/div>
              &lt;div className="buttonContainer">
                &lt;Button type="submit">Enviar para análise&lt;/Button>
              &lt;/div>
            &lt;/>
          )}
        &lt;/form>
        &lt;footer>
          &lt;Footer />
        &lt;/footer>
      &lt;/div>
    &lt;/>
  );
}

export default Criarcarro;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#App">App</a></li><li><a href="global.html#Atualizarcarrocard">Atualizarcarrocard</a></li><li><a href="global.html#Atualizardadoscarro">Atualizardadoscarro</a></li><li><a href="global.html#Botaocriarcarro">Botaocriarcarro</a></li><li><a href="global.html#Criarcarro">Criarcarro</a></li><li><a href="global.html#Footer">Footer</a></li><li><a href="global.html#FormClientes">FormClientes</a></li><li><a href="global.html#Formcriarcarro">Formcriarcarro</a></li><li><a href="global.html#HistoricoDetalhes">HistoricoDetalhes</a></li><li><a href="global.html#Input">Input</a></li><li><a href="global.html#Login">Login</a></li><li><a href="global.html#Message">Message</a></li><li><a href="global.html#Pagamento">Pagamento</a></li><li><a href="global.html#PrivateRoute">PrivateRoute</a></li><li><a href="global.html#ProtectedAdminRoutes">ProtectedAdminRoutes</a></li><li><a href="global.html#containsArray">containsArray</a></li><li><a href="global.html#createRegistro">createRegistro</a></li><li><a href="global.html#criarCarro">criarCarro</a></li><li><a href="global.html#findCarroById">findCarroById</a></li><li><a href="global.html#getAllAluguel">getAllAluguel</a></li><li><a href="global.html#getAllAluguelByUser">getAllAluguelByUser</a></li><li><a href="global.html#getAllCarros">getAllCarros</a></li><li><a href="global.html#getAllCarrosByUser">getAllCarrosByUser</a></li><li><a href="global.html#getAllRegistro">getAllRegistro</a></li><li><a href="global.html#getAllRegistroByUser">getAllRegistroByUser</a></li><li><a href="global.html#getAllUser">getAllUser</a></li><li><a href="global.html#initialClienteData">initialClienteData</a></li><li><a href="global.html#reportWebVitals">reportWebVitals</a></li><li><a href="global.html#root">root</a></li><li><a href="global.html#updateCarroByUser">updateCarroByUser</a></li><li><a href="global.html#updateDiasAlugado">updateDiasAlugado</a></li><li><a href="global.html#useAluguelStore">useAluguelStore</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Mon Sep 09 2024 21:58:23 GMT-0300 (Horário Padrão de Brasília)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
